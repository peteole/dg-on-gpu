<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TerraDG.jl on the GPU · TerraDG Documentation</title><meta name="title" content="TerraDG.jl on the GPU · TerraDG Documentation"/><meta property="og:title" content="TerraDG.jl on the GPU · TerraDG Documentation"/><meta property="twitter:title" content="TerraDG.jl on the GPU · TerraDG Documentation"/><meta name="description" content="Documentation for TerraDG Documentation."/><meta property="og:description" content="Documentation for TerraDG Documentation."/><meta property="twitter:description" content="Documentation for TerraDG Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>TerraDG Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>TerraDG.jl on the GPU</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Main"><span>Main</span></a></li><li class="toplevel"><a class="tocitem" href="#I/O"><span>I/O</span></a></li><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#VTK/Paraview-output"><span>VTK/Paraview output</span></a></li><li><a class="tocitem" href="#Error-Writer"><span>Error Writer</span></a></li><li class="toplevel"><a class="tocitem" href="#Equations"><span>Equations</span></a></li><li class="toplevel"><a class="tocitem" href="#Grid"><span>Grid</span></a></li><li><a class="tocitem" href="#Basis"><span>Basis</span></a></li><li class="toplevel"><a class="tocitem" href="#Kernels"><span>Kernels</span></a></li><li><a class="tocitem" href="#Global-Matrices"><span>Global Matrices</span></a></li><li><a class="tocitem" href="#Time"><span>Time</span></a></li><li><a class="tocitem" href="#Surface"><span>Surface</span></a></li><li><a class="tocitem" href="#Volume"><span>Volume</span></a></li><li><a class="tocitem" href="#Flux"><span>Flux</span></a></li><li><a class="tocitem" href="#Slope-limiting"><span>Slope limiting</span></a></li><li><a class="tocitem" href="#Initial-Conditions"><span>Initial Conditions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>TerraDG.jl on the GPU</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>TerraDG.jl on the GPU</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="TerraDG.jl-on-the-GPU"><a class="docs-heading-anchor" href="#TerraDG.jl-on-the-GPU">TerraDG.jl on the GPU</a><a id="TerraDG.jl-on-the-GPU-1"></a><a class="docs-heading-anchor-permalink" href="#TerraDG.jl-on-the-GPU" title="Permalink"></a></h1><p><a href="http://www.youtube.com/watch?v=3WDuZH6MymY &quot;Euler equations solution&quot;"><img src="http://img.youtube.com/vi/3WDuZH6MymY/0.jpg" alt="Euler equations solution"/></a></p><p>This is a solution of the Euler equations using the TerraDG.jl package on the GPU. The video shows the density of the fluid at different time steps. The simulation is run on a 500x500 grid with a fourth-order solver.</p><h3 id="Running-the-code"><a class="docs-heading-anchor" href="#Running-the-code">Running the code</a><a id="Running-the-code-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-code" title="Permalink"></a></h3><ul><li>Clone the repo</li><li>Start Julia in the root directory of the project with <code>julia --project=.</code>. Optionally, you can set the number of threads with <code>export JULIA_NUM_THREADS=8</code>.</li><li>Run <code>] instantiate</code> to install the dependencies.</li><li>Run <code>include(&quot;src/main.jl&quot;)</code> to run the code. You can change the parameters in the <code>main.jl</code> file. Note that the increased complexity and number of dependencies of the project increased precompilation time, sometimes taking up to around 3 minutes.</li></ul><p>In addition to the parameters from the worksheets, you can specify the following parameters in the input file:</p><ul><li><code>solver.slope_limiting: true</code>: Activate minmod slope limiting.</li><li><code>simulation.device: cuda:3</code>: Select the device to run the simulation on. The default is <code>cpu</code>. Allowed values are <code>cpu</code>,<code>cuda</code>, <code>cuda:X</code>, where <code>X</code> is the device number, <code>amdgpu</code>, <code>amdgpu:X</code>, where <code>X</code> is the device number.</li><li><code>simulation.float_type: Float32</code>: Select the floating point precision. Allowed values are <code>Float32</code> and <code>Float64</code>.</li><li><code>output.save_images: true</code>: Save plots of each dof in the <code>plots</code> folder.</li><li><code>output.log_level: warn</code>: Set the log level. Allowed values are <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code>.</li></ul><h3 id="Running-the-code-with-Docker"><a class="docs-heading-anchor" href="#Running-the-code-with-Docker">Running the code with Docker</a><a id="Running-the-code-with-Docker-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-code-with-Docker" title="Permalink"></a></h3><ul><li>Build the Docker image with <code>docker build -t terradg .</code>.</li><li>Run the Docker container with <code>docker run -it terradg</code>. This will start an interactive Julia session in the TerraDG project.</li><li>Run your experiment using <code>using TerraDG; TerraDG.main(&quot;src/input/advection.yaml&quot;)</code>.</li></ul><p>If you also wish to play with the inputs and inspect the plots, you can mount the<code>src/input</code>, <code>output</code> and <code>plots</code> directories to your host machine. First create the folders if they do not exist: <code>mkdir plots;mkdir output</code>. For example, run <code>docker run -it -v $(pwd)/src/input:/app/src/input -v $(pwd)/output:/app/output -v $(pwd)/plots:/app/plots terradg</code>. Note that GPU acceleration is not available in the Docker container.</p><h3 id="Folder-structure"><a class="docs-heading-anchor" href="#Folder-structure">Folder structure</a><a id="Folder-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Folder-structure" title="Permalink"></a></h3><ul><li><code>src</code>: Contains the source code of the project.</li><li><code>results</code>: Contains documentation for all worksheets</li><li><code>benchmark</code>: Contains benchmarking scripts and results</li><li><code>output</code>: Contains the output of the simulation in vtk format. Can be opened with Paraview.</li><li><code>plots</code>: Contains plots of the simulation. Can be disabled in the input file.</li><li><code>test</code>: Contains the tests for the project.</li><li><code>worksheets.ipynb</code>: Contains the output of all worksheets in a Jupyter notebook. Running this notebook runs all the worksheet configs. In the <code>cuda_video_output</code> branch, this file contains the output as a video. However, we experienced compatibility issues.</li></ul><h3 id="Branches-and-tags"><a class="docs-heading-anchor" href="#Branches-and-tags">Branches and tags</a><a id="Branches-and-tags-1"></a><a class="docs-heading-anchor-permalink" href="#Branches-and-tags" title="Permalink"></a></h3><ul><li>branch <code>main</code>: Contains the project implementation with all optimizations.</li><li>tags <code>worksheet-X</code> (X=1,2,3,4): Contains the implementation of the respective worksheet.</li><li>branch <code>cuda_video_output</code>: Contains the implementation of the video output for the Euler equations on the GPU in the <code>worksheets.ipynb</code> file.</li><li>branch <code>cuda_derivative_factorization</code>: Contains the project but without the surface integral optimization. More flexible (we do not make assumptions about the order of the cells here) and readable code but around 30% slower.</li></ul><h3 id="Testing"><a class="docs-heading-anchor" href="#Testing">Testing</a><a id="Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Testing" title="Permalink"></a></h3><p>Run <code>] test</code> to run the tests.</p><ul><li><a href="#TerraDG.jl-on-the-GPU">TerraDG.jl on the GPU</a></li><li><a href="#Main">Main</a></li><li><a href="#I/O">I/O</a></li><li class="no-marker"><ul><li><a href="#Configuration">Configuration</a></li><li><a href="#VTK/Paraview-output">VTK/Paraview output</a></li><li><a href="#Error-Writer">Error Writer</a></li></ul></li><li><a href="#Equations">Equations</a></li><li><a href="#Grid">Grid</a></li><li class="no-marker"><ul><li><a href="#Basis">Basis</a></li></ul></li><li><a href="#Kernels">Kernels</a></li><li class="no-marker"><ul><li><a href="#Global-Matrices">Global Matrices</a></li><li><a href="#Time">Time</a></li><li><a href="#Surface">Surface</a></li><li><a href="#Volume">Volume</a></li><li><a href="#Flux">Flux</a></li><li><a href="#Slope-limiting">Slope limiting</a></li><li><a href="#Initial-Conditions">Initial Conditions</a></li><li><a href="#Index">Index</a></li></ul></li></ul><h1 id="Main"><a class="docs-heading-anchor" href="#Main">Main</a><a id="Main-1"></a><a class="docs-heading-anchor-permalink" href="#Main" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_rhs" href="#TerraDG.evaluate_rhs"><code>TerraDG.evaluate_rhs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_rhs(eq, scenario, filter, globals, du, dofs, grid)</code></pre><p>Evalutes the right-hand-side of the equation <code>eq</code> for  scenario <code>scenario</code>, with filter <code>filter</code>,  collection of global matrices <code>globals</code>, update <code>du</code>, degrees of freedom <code>dofs</code> and grid <code>grid</code>.</p><p>Updates <code>du</code> in place.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.main" href="#TerraDG.main"><code>TerraDG.main</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">main(configfile::String)</code></pre><p>Runs a DG-simulation with configuration from <code>configfile</code>.</p></div></section></article><h1 id="I/O"><a class="docs-heading-anchor" href="#I/O">I/O</a><a id="I/O-1"></a><a class="docs-heading-anchor-permalink" href="#I/O" title="Permalink"></a></h1><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Configuration" href="#TerraDG.Configuration"><code>TerraDG.Configuration</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Configuration(configfile::String)</code></pre><p>Parses configuration file <code>configfile</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_device_array_type" href="#TerraDG.get_device_array_type"><code>TerraDG.get_device_array_type</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Gets the array type for the device specified in the configuration. Also sets the default device and dynamically loads the corresponding accelerator module.</p></div></section></article><h2 id="VTK/Paraview-output"><a class="docs-heading-anchor" href="#VTK/Paraview-output">VTK/Paraview output</a><a id="VTK/Paraview-output-1"></a><a class="docs-heading-anchor-permalink" href="#VTK/Paraview-output" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.VTKPlotter" href="#TerraDG.VTKPlotter"><code>TerraDG.VTKPlotter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">VTKPlotter(eq::Equation, scenario::Scenario, grid::Grid,
           filename::String)</code></pre><p>Initialize a VTKPlotter for equation <code>eq</code> and scenario <code>scenario</code>, defined on <code>grid_gpu</code>. The gpu grid is copied to cpu for plotting. Output name is <code>filename</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.plot" href="#TerraDG.plot"><code>TerraDG.plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot(plotter::VTKPlotter)</code></pre><p>Write output with <code>plotter</code> for timestep.</p><p>This function is asynchronous and returns immediately after copying the grid.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.save" href="#TerraDG.save"><code>TerraDG.save</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">save(plotter::VTKPlotter)</code></pre><p>Save final output file for <code>plotter</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_dof_points" href="#TerraDG.evaluate_dof_points"><code>TerraDG.evaluate_dof_points</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_dof_points(grid::Grid, points, dofidx)</code></pre><p>Evaluate the DOF points for <code>dofidx</code> on <code>grid</code> at <code>points</code>, potentially on GPU.</p><p>Returns the evaluated data of size <code>(length(grid.cells)*num_points, 1)</code>.</p></div></section></article><h2 id="Error-Writer"><a class="docs-heading-anchor" href="#Error-Writer">Error Writer</a><a id="Error-Writer-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Writer" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_error" href="#TerraDG.evaluate_error"><code>TerraDG.evaluate_error</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_error(eq, scenario, grid, t)</code></pre><p>Evaluates the error of the solution for the equation <code>eq</code> and scenario <code>scenario</code> on the grid <code>grid</code> at time <code>t</code>. Writes the error to the console. Evaluates the error in the L1, L2 and L∞ norms.</p></div></section></article><h1 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Equation" href="#TerraDG.Equation"><code>TerraDG.Equation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>This abstract type needs to be implemented by all equations.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.make_equation" href="#TerraDG.make_equation"><code>TerraDG.make_equation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_equation(config::Configuration)</code></pre><p>Returns equation object for configuration <code>config</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Scenario" href="#TerraDG.Scenario"><code>TerraDG.Scenario</code></a> — <span class="docstring-category">Type</span></header><section><div><p>This abstract type needs to be implementred by all scenarios</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.make_scenario" href="#TerraDG.make_scenario"><code>TerraDG.make_scenario</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_scenario(config::Configuration)</code></pre><p>Returns scenario object for configuration <code>config</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.interpolate_initial_dofs" href="#TerraDG.interpolate_initial_dofs"><code>TerraDG.interpolate_initial_dofs</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function initializes the discrete solution at t = 0 for an equation <code>eq</code> and a scenario <code>scenario</code>. It evaluates get_initial_values for <code>eq</code> and <code>scenario</code> at the global coordinates of our nodes. It then interpolates this on the <code>basis</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_nvars" href="#TerraDG.get_nvars"><code>TerraDG.get_nvars</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function returns the number of variables for equation <code>eq::Equation</code></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_nparams" href="#TerraDG.get_nparams"><code>TerraDG.get_nparams</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function returns the number of material parameters for equation <code>eq::Equation</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_variable_name" href="#TerraDG.get_variable_name"><code>TerraDG.get_variable_name</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_variable_name(eq::Equation, variable_index)</code></pre><p>Return the name of the variable with index <code>variable_index</code> for equation <code>eq::Equation</code>.</p><p><strong>Implementation</strong></p><p>Custom equations need to define <code>get_variable_names(eq)</code> for this to work.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.is_periodic_boundary" href="#TerraDG.is_periodic_boundary"><code>TerraDG.is_periodic_boundary</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_periodic_boundary(equation::Equation, scenario::Scenario)</code></pre><p>Returns true if all boundary conditions should be periodic for equation <code>eq::Equation</code> and scenario <code>scenario::Scenario</code>.</p></div></section><section><div><p>is<em>periodic</em>boundary(eq::Acoustic, scenario::GaussianWave) The GaussianWave scenario does not require periodic boundary conditions.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_boundary" href="#TerraDG.evaluate_boundary"><code>TerraDG.evaluate_boundary</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_boundary(eq::Equation, scenario::Equation, face, normalidx, dofsface, dofsfaceneigh)</code></pre><p>Evaluate the boundary condition, defined for equation <code>eq</code> and <code>scenario</code>, on face <code>face</code> with <code>normalidx</code>. Store dofs of ghost cell in <code>dofsfaceneigh</code>. You can use inner (face)-dofs <code>dofsface</code> to construct to boundary.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_initial_values" href="#TerraDG.get_initial_values"><code>TerraDG.get_initial_values</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_initial_values(eq::Equation, scenario::Scenario, global_position; t=0.0)</code></pre><p>Return a vector of initial values for equation <code>eq</code> and scenario <code>scenario</code> at  <code>global_positon</code> and at time <code>t</code>. Values other than <code>t = 0</code> only have to be supported if <code>is_analytical_solution</code> returns true.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.is_analytical_solution" href="#TerraDG.is_analytical_solution"><code>TerraDG.is_analytical_solution</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_analytical_solution(equation::Equation, scenario::Scenario)</code></pre><p>Returns true if the initial condition is also an analytical solution  for equation <code>equation</code> and scenario <code>scenario</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_flux" href="#TerraDG.evaluate_flux"><code>TerraDG.evaluate_flux</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_flux(eq::Equation, celldofs, cellflux)</code></pre><p>Evaluate the flux for equation <code>eq</code> and dofs <code>celldofs</code>, Stores them in <code>cellflux</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.max_eigenval" href="#TerraDG.max_eigenval"><code>TerraDG.max_eigenval</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">max_eigenval(eq::Equation, celldata, normalidx)</code></pre><p>Return the maximum eigenvalue in direction of <code>normalidx</code> for <code>celldata</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.@declare_dofs" href="#TerraDG.@declare_dofs"><code>TerraDG.@declare_dofs</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">declare_dofs(eq, dof_names, num_params=0)</code></pre><p>Generate boilerplate code for equation type <code>eq</code> which has degrees of freedom named <code>dof_names</code> (should be iterable of symbols) and <code>num_params</code> parameters. Generates</p><pre><code class="nohighlight hljs">get_variable_names(eq)
get_ndofs(eq)
get_nvars(eq)
get_nparams(eq)</code></pre><p>Also generates a struct called [typename]Shortcuts.</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">struct Advection &lt;: Equation end
@declare_dofs Advection [:ρ_1, :ρ_2, :ρ_3]</code></pre><p>Generates:</p><pre><code class="nohighlight hljs">get_variable_names(eq::Advection) = [:ρ_1, :ρ_2, :ρ_3]
get_ndofs(eq::Advection) = 3
get_nvars(eq::Advection) = 3
get_nparams(eq::Advection) = 0</code></pre><p>You can use the struct in this way:</p><pre><code class="nohighlight hljs">s = AdvectionShortcuts()
@assert s.ρ_1 == 1
@assert s.ρ_2 == 2
@assert s.ρ_3 == 3</code></pre></div></section></article><h1 id="Grid"><a class="docs-heading-anchor" href="#Grid">Grid</a><a id="Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Grid" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.FaceType" href="#TerraDG.FaceType"><code>TerraDG.FaceType</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">@enum FaceType regular=1 boundary=2</code></pre><p>Regular faces are faces that have another cell as neighbor. Boundary faces are faces on the boundary, i.e., where we need to construct a solution at each timestep.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Cell" href="#TerraDG.Cell"><code>TerraDG.Cell</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Cell</code></pre><p><code>Cell</code> stores all information about grid cells, such as their center <code>center</code>, their size <code>size</code>. It also contains information about its <code>neighbors</code>. In case it is neighbored by a boundary cell, <code>facetypes</code>  indicates this and the neighbor is undefined. Finally, it stores the <code>dataidx</code> which denotes at which position the data for the cell is stored in the relevant data arrays.</p><p>The Cell is parameterized by the floating point type <code>F</code>, the number of dimensions <code>ndims</code> and the number of neighbors <code>num_neighbors</code>, making it fixed size.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Grid" href="#TerraDG.Grid"><code>TerraDG.Grid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Grid</code></pre><p><code>Grid</code> stores information about the grid and also information about the whole simulation. It contains the <code>basis</code> for the grid, the <code>cells</code> of the grid, the <code>size</code> of the grid, the degrees of freedom <code>dofs</code> and the fluxes <code>flux</code>. It also contains the <code>maxeigenval</code> which is the maximum eigenvalue of the grid, the current <code>time</code> of the simulation, the <code>eigenvals</code> of the grid and the <code>neighbour_face_flux_buffer</code> which is used for the surface integral. Finally, it stores the <code>cellsize</code> of the cells.</p><p>It is parameterized by the floating point type <code>F</code>, the type of the cells <code>T1</code>, the type of the degrees of freedom <code>T2</code>, the number of dimensions <code>ndims</code>, the number of degrees of freedom <code>ndofs</code>, the order of the basis <code>order</code> and the type of the eigenvalues <code>T3</code>. <code>T1</code>, <code>T2</code> and <code>T3</code> are arrays potentially stored on the GPU.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Face" href="#TerraDG.Face"><code>TerraDG.Face</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">@enum Face left=1 top=2 right=3 bottom=4</code></pre><p><code>Face</code> describes the ordering of our faces. The order is irrelevant as long as the same order is used everywhere. Using the wrong order leads to very hard bugs!</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_neighbor" href="#TerraDG.get_neighbor"><code>TerraDG.get_neighbor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_neighbor(eq, scenario, index, maxindex, offset)</code></pre><p>Returns the index of the neighboring cell. Here, <code>index</code> is the 2d-index of the current cell, <code>maxindex</code> is the maximum index, and <code>offset</code> is the difference in index of the neighbor. As minimum index (0,0) is assumed. Returns both the index of the neighbor and the type of the face. It handles both periodic boundary cells (returns correct neighbor and regular face type) and proper boundaries (returns periodic neighbor and boundary face type).</p><p><strong>Implementation</strong></p><p>The type of boundaries depends on the <code>equation</code> and the <code>scenario</code>. Users can overwrite the function is<em>periodic</em>boundary.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.make_mesh" href="#TerraDG.make_mesh"><code>TerraDG.make_mesh</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_mesh(eq, scenario, gridsize_1d, cellsize, offset)</code></pre><p>Returns all cells of a mesh with number of cel(per dimension) given by  <code>gridsize_1d</code>, size of each cell by <code>cellsize</code> and <code>offset</code> of grid.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.make_grid" href="#TerraDG.make_grid"><code>TerraDG.make_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_grid(eq::Equation, scenario::Scenario, gridsize_1d, size, order, ::Type{T}=Array,::Type{F}=Float64)</code></pre><p>Returns a grid for equation <code>eq</code>, scenario <code>scenario</code>, with cells of size <code>size</code>     and number of cells per dimension equals to <code>gridsize_1d</code>. The type of array and the floating point precision can be specified.</p></div></section><section><div><pre><code class="language-julia hljs">make_grid(config::Configuration, eq::Equation, scenario::Scenario)</code></pre><p>Returns a grid for configuration <code>config</code>, equation <code>eq</code> and scenario <code>scenario</code></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.globalposition" href="#TerraDG.globalposition"><code>TerraDG.globalposition</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">globalposition(cell:Cell, coordinate_reference)</code></pre><p>Returns the global positon of reference coordinates <code>coordinate_reference</code> for a cell with center <code>cellcenter</code> and size <code>cellsize</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.volume" href="#TerraDG.volume"><code>TerraDG.volume</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">volume(cell::Cell)</code></pre><p>Returns the volume of a quad <code>cell</code>. In 2D, it returns the area.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.area" href="#TerraDG.area"><code>TerraDG.area</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">area(cell::Cell)</code></pre><p>Returns the area of a quad <code>cell</code>. In 1D, it returns the side-length.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.inverse_jacobian" href="#TerraDG.inverse_jacobian"><code>TerraDG.inverse_jacobian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inverse_jacobian(cellsize::NTuple{ndims,F})</code></pre><p>Returns the inverse jacobian of a cell with size <code>cellsize</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.cpu" href="#TerraDG.cpu"><code>TerraDG.cpu</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Move all the data of the grid to the CPU, returns a new grid.</p></div></section></article><h2 id="Basis"><a class="docs-heading-anchor" href="#Basis">Basis</a><a id="Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Basis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.lagrange_1d" href="#TerraDG.lagrange_1d"><code>TerraDG.lagrange_1d</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lagrange_1d(points, i, x)</code></pre><p>Evaluate the Lagrange interpolation polynomial defined over nodal <code>points</code> with index <code>i</code> at point <code>x</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.lagrange_diff" href="#TerraDG.lagrange_diff"><code>TerraDG.lagrange_diff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lagrange_diff(points, i, x)</code></pre><p>Evaluate the derivative of the Lagrange interpolation polynomial defined over nodal <code>points</code>  with index <code>i</code> at point <code>x</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_quadpoints" href="#TerraDG.get_quadpoints"><code>TerraDG.get_quadpoints</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_quadpoints(n)</code></pre><p>Compute quadrature points and weights for Gaussian quadrature of order <code>n</code>. The points (and thus the corresponding weights) are normalized to the range <span>$[0.0, 1.0]$</span>.</p><p>Return a tuple of <code>points, weights</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.Basis" href="#TerraDG.Basis"><code>TerraDG.Basis</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Basis</code></pre><p>A standard 1-dimensional basis of <code>order::Integer</code> with <code>quadpoints::Array{Float64,1}</code> and  corresponding <code>quadweights::Array{Float64,1}</code> Is the basis (pun intended) for tensor-product bases.</p><pre><code class="nohighlight hljs">Basis(order::Integer, dimensions)</code></pre><p>Initialize a basis of <code>order::Integer</code> and dimensions <code>dimensions</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{TerraDG.Basis}" href="#Base.length-Tuple{TerraDG.Basis}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.length(basis::Basis)</code></pre><p>Return number of points for <code>basis</code> in n-dimensions.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size-Tuple{TerraDG.Basis}" href="#Base.size-Tuple{TerraDG.Basis}"><code>Base.size</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.size(basis::Basis)</code></pre><p>Return number of points for <code>basis</code> for each dimensions as tuple.</p></div></section><section><div><pre><code class="language-julia hljs">Base.size(basis::Basis, dim)</code></pre><p>Return number of points for <code>basis</code> for dimensions <code>dim</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size-Tuple{TerraDG.Basis, Integer}" href="#Base.size-Tuple{TerraDG.Basis, Integer}"><code>Base.size</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.size(basis::Basis, dim)</code></pre><p>Return number of points for <code>basis</code> for dimensions <code>dim</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size" href="#Base.size"><code>Base.size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.size(basis::Basis)</code></pre><p>Return number of points for <code>basis</code> for each dimensions as tuple.</p></div></section><section><div><pre><code class="language-julia hljs">Base.size(basis::Basis, dim)</code></pre><p>Return number of points for <code>basis</code> for dimensions <code>dim</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_basis" href="#TerraDG.evaluate_basis"><code>TerraDG.evaluate_basis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_basis(basis::Basis, coeffs, x)</code></pre><p>Evaluate the <code>basis</code> with coefficients <code>coeffs</code> at point <code>x</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.project_to_reference_basis" href="#TerraDG.project_to_reference_basis"><code>TerraDG.project_to_reference_basis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">project_to_reference_basis(fun, basis::Basis, ndofs)</code></pre><p>Project the result of the function <code>fun</code> to coefficients of the basis built of a tensor-product of <code>basis</code>. The function <code>fun(x,y)</code>  takes in the <span>$x, y$</span>-coordinates and returns a vector with size <code>ndofs</code>. The corresponding coefficients are returned.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.massmatrix" href="#TerraDG.massmatrix"><code>TerraDG.massmatrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">massmatrix(basis, dimensions)</code></pre><p>Return the mass-matrix for a <code>dimensions</code>-dimensional tensor-product basis built up from the 1d-basis <code>basis</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.derivativematrix" href="#TerraDG.derivativematrix"><code>TerraDG.derivativematrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">derivativematrix(basis)</code></pre><p>Returns the 2-dimensional derivative matrix for <code>basis</code>. Multiplying this with flux-coefficients of shape <code>(dimensions * basissize_2d, ndofs)</code> returns the coefficients of the corresponding derivative.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.get_face_quadpoints" href="#TerraDG.get_face_quadpoints"><code>TerraDG.get_face_quadpoints</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_face_quadpoints(basis::Basis, face)</code></pre><p>Return the quadrature points at the face <code>face</code> for basis <code>basis</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.face_projection_matrix" href="#TerraDG.face_projection_matrix"><code>TerraDG.face_projection_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">face_projection_matrix(basis, face)</code></pre><p>Return the face projection matrix for <code>basis</code> and <code>face</code>. Multiplying it with coefficient vector for the right basis returns the coefficients of the solution evaluated at the  quadrature nodes of the face.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_m_to_n_vandermonde_basis" href="#TerraDG.evaluate_m_to_n_vandermonde_basis"><code>TerraDG.evaluate_m_to_n_vandermonde_basis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_m_to_n_vandermonde_basis(basis)</code></pre><p>Return the Vandermonde matrix that converts between the 2D-modal  (normalized) Legendre-basis and the 2D-nodal tensor-product basis built with <code>basis</code>.</p></div></section></article><h1 id="Kernels"><a class="docs-heading-anchor" href="#Kernels">Kernels</a><a id="Kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Kernels" title="Permalink"></a></h1><p>Many kernels take both global matrices and buffers. Try to use them to avoid costly re-computations or memory allocations.</p><h2 id="Global-Matrices"><a class="docs-heading-anchor" href="#Global-Matrices">Global Matrices</a><a id="Global-Matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Global-Matrices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.GlobalMatrices" href="#TerraDG.GlobalMatrices"><code>TerraDG.GlobalMatrices</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct GlobalMatrices</code></pre><p>Stores global matrices and some other things. Everything that is very expensive to compute which stays constant throughout the simulation should be stored here.</p><pre><code class="nohighlight hljs">GlobalMatrices(basis::Basis, filter::Filter, dimensions)</code></pre><p>Initialize GlobalMatrices for <code>basis</code>, <code>filter</code> and <code>dimensions</code>.</p></div></section></article><h2 id="Time"><a class="docs-heading-anchor" href="#Time">Time</a><a id="Time-1"></a><a class="docs-heading-anchor-permalink" href="#Time" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.TimeIntegrator" href="#TerraDG.TimeIntegrator"><code>TerraDG.TimeIntegrator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type TimeIntegrator</code></pre><p>Abstract type for ODE-Integrators. They should store the update as internal state to  avoid costly reallocations.</p><p><strong>Implementation</strong></p><p>For new integrators, the method <code>step</code> needs to be  overwritten. This method should modify the dofs stored in the grid in-place.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.make_timeintegrator" href="#TerraDG.make_timeintegrator"><code>TerraDG.make_timeintegrator</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_timeintegrator(config::Configuration, grid::Grid)</code></pre><p>Returns time integrator from <code>config</code> for <code>grid</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.step" href="#TerraDG.step"><code>TerraDG.step</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step(f, integrator::ExplicitEuler, grid, dt)</code></pre><p>Performs an update with the explicit euler method on <code>grid</code> and timestepsize <code>dt</code>.</p></div></section><section><div><pre><code class="language-julia hljs">step(f, integrator::SSPRK3, grid, dt)</code></pre><p>Performs an update with the SSPRK3 method on <code>grid</code> and timestepsize <code>dt</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.ExplicitEuler" href="#TerraDG.ExplicitEuler"><code>TerraDG.ExplicitEuler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExplicitEuler(grid::Grid)</code></pre><p>Return Euler time-integrator for <code>grid</code>. First order accurate.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.SSPRK2" href="#TerraDG.SSPRK2"><code>TerraDG.SSPRK2</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SSPRK2(grid::Grid)</code></pre><p>Return SSPRK2 time-integrator for <code>grid</code>. Two-stage strong-stability preserving Runge Kutta method. Second order accurate.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.SSPRK3" href="#TerraDG.SSPRK3"><code>TerraDG.SSPRK3</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SSPRK3(grid::Grid)</code></pre><p>Return SSPRK3 time-integrator for <code>grid</code>. Three-stage strong-stability preserving Runge Kutta method. Third order accurate.</p></div></section></article><h2 id="Surface"><a class="docs-heading-anchor" href="#Surface">Surface</a><a id="Surface-1"></a><a class="docs-heading-anchor-permalink" href="#Surface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.project_to_face" href="#TerraDG.project_to_face"><code>TerraDG.project_to_face</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">project_to_face(projection_vector_0,projection_vector_1, dofs, faceval)</code></pre><p>Projects the dofs to the face using the projection vectors and the bottom face. Uses sum factorization to avoid unnecessary allocations.</p><p>The <code>Val</code> argument is used to dispatch on the face at compile time.</p></div></section><section><div><pre><code class="language-julia hljs">project_to_face(projection_vector_0,projection_vector_1, dofs, faceval)</code></pre><p>Projects the dofs to the face using the projection vectors and the top face. Uses sum factorization to avoid unnecessary allocations.</p></div></section><section><div><pre><code class="language-julia hljs">project_to_face(projection_vector_0,projection_vector_1, dofs, faceval)</code></pre><p>Projects the dofs to the face using the projection vectors and the left face. Uses sum factorization to avoid unnecessary allocations.</p></div></section><section><div><pre><code class="language-julia hljs">project_to_face(projection_vector_0,projection_vector_1, dofs, faceval)</code></pre><p>Projects the dofs to the face using the projection vectors and the right face. Uses sum factorization to avoid unnecessary allocations.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_face_integrals" href="#TerraDG.evaluate_face_integrals"><code>TerraDG.evaluate_face_integrals</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This version of the face integral relies on a certain order of the cells, as created in grid.jl. We iterate over all faces and compute the numerical fluxes and the updates for the cells neighboring the face. This function uses sum factorizations.</p><p>For a more simple and compatible version, see the <code>cuda_derivative_factorization</code> branch.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.project_flux_to_face" href="#TerraDG.project_flux_to_face"><code>TerraDG.project_flux_to_face</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">project_flux_to_face(face_projection_matrix_for_face, flux)</code></pre><p>Projects the flux to the face using the sum factorization. First splits the flux into x and y components, then projects them to the face, and finally concatenates them.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.project_face_to_inner" href="#TerraDG.project_face_to_inner"><code>TerraDG.project_face_to_inner</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">project_face_to_inner(projection_vector_0,projection_vector_1, facedofs, faceval)</code></pre><p>Projects the face dofs to the inner dofs using the projection vectors. Legacy version, using sum factorization.</p><p>Same as <code>projection_matrix&#39; * facedofs</code></p></div></section></article><h2 id="Volume"><a class="docs-heading-anchor" href="#Volume">Volume</a><a id="Volume-1"></a><a class="docs-heading-anchor-permalink" href="#Volume" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_volumes" href="#TerraDG.evaluate_volumes"><code>TerraDG.evaluate_volumes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_volumes(globals::GlobalMatrices, grid::Grid{F,T1,T2,2,ndofs,order,T3}, du::T2) where {F,T1&lt;:AbstractArray,T2&lt;:AbstractArray,ndofs,order,T3}</code></pre><p>Evaluates the volume integrals for the DG-scheme on the grid <code>grid</code> with global matrices <code>globals</code> and update <code>du</code>.</p><p>Updates <code>du</code> in place.</p><p>Potentially runs on the GPU through a kernel.</p></div></section></article><h2 id="Flux"><a class="docs-heading-anchor" href="#Flux">Flux</a><a id="Flux-1"></a><a class="docs-heading-anchor-permalink" href="#Flux" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.evaluate_fluxes" href="#TerraDG.evaluate_fluxes"><code>TerraDG.evaluate_fluxes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evaluate_fluxes(eq::Equation, grid::Grid, dofs)</code></pre><p>Evaluates the fluxes for the given equation <code>eq</code> on the grid <code>grid</code> with the given degrees of freedom <code>dofs</code>. Updates <code>grid.flux</code> in place. Possibly runs on a GPU.</p></div></section></article><h2 id="Slope-limiting"><a class="docs-heading-anchor" href="#Slope-limiting">Slope limiting</a><a id="Slope-limiting-1"></a><a class="docs-heading-anchor-permalink" href="#Slope-limiting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.minmod_slope_limiting!" href="#TerraDG.minmod_slope_limiting!"><code>TerraDG.minmod_slope_limiting!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">minmod_slope_limiting!(grid::Grid, buffer::SlopeLimitingBuffer)</code></pre><p>Perform slope minmod limiting on the grid <code>grid</code> using the cell averages and slopes stored in <code>buffer</code>. Potentially runs on a GPU.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.SlopeLimitingBuffer" href="#TerraDG.SlopeLimitingBuffer"><code>TerraDG.SlopeLimitingBuffer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SlopeLimitingBuffer</code></pre><p>A buffer to store the cell averages and slopes for slope limiting.     All fields are potentially on GPU.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.compute_slope_limiting_coefficients!" href="#TerraDG.compute_slope_limiting_coefficients!"><code>TerraDG.compute_slope_limiting_coefficients!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_slope_limiting_coefficients!(grid::Grid, buffer::SlopeLimitingBuffer)</code></pre><p>Compute the cell averages and slopes for slope limiting on the grid <code>grid</code> and store them in <code>buffer</code>. Potentially runs on a GPU. Slopes and averages are estimated using Gauss quadrature.</p></div></section></article><h2 id="Initial-Conditions"><a class="docs-heading-anchor" href="#Initial-Conditions">Initial Conditions</a><a id="Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TerraDG.set_initial_conditions" href="#TerraDG.set_initial_conditions"><code>TerraDG.set_initial_conditions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_initial_conditions(eq::Equation, scenario::Scenario, grid::Grid)</code></pre><p>Sets the initial conditions for the given equation <code>eq</code> and scenario <code>scenario</code> on the grid <code>grid</code>. Possibly runs on a GPU.</p></div></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#TerraDG.Basis"><code>TerraDG.Basis</code></a></li><li><a href="#TerraDG.Cell"><code>TerraDG.Cell</code></a></li><li><a href="#TerraDG.Configuration"><code>TerraDG.Configuration</code></a></li><li><a href="#TerraDG.Equation"><code>TerraDG.Equation</code></a></li><li><a href="#TerraDG.ExplicitEuler"><code>TerraDG.ExplicitEuler</code></a></li><li><a href="#TerraDG.Face"><code>TerraDG.Face</code></a></li><li><a href="#TerraDG.FaceType"><code>TerraDG.FaceType</code></a></li><li><a href="#TerraDG.GlobalMatrices"><code>TerraDG.GlobalMatrices</code></a></li><li><a href="#TerraDG.Grid"><code>TerraDG.Grid</code></a></li><li><a href="#TerraDG.SSPRK2"><code>TerraDG.SSPRK2</code></a></li><li><a href="#TerraDG.SSPRK3"><code>TerraDG.SSPRK3</code></a></li><li><a href="#TerraDG.Scenario"><code>TerraDG.Scenario</code></a></li><li><a href="#TerraDG.SlopeLimitingBuffer"><code>TerraDG.SlopeLimitingBuffer</code></a></li><li><a href="#TerraDG.TimeIntegrator"><code>TerraDG.TimeIntegrator</code></a></li><li><a href="#TerraDG.VTKPlotter"><code>TerraDG.VTKPlotter</code></a></li><li><a href="#Base.length-Tuple{TerraDG.Basis}"><code>Base.length</code></a></li><li><a href="#Base.size-Tuple{TerraDG.Basis}"><code>Base.size</code></a></li><li><a href="#Base.size"><code>Base.size</code></a></li><li><a href="#Base.size-Tuple{TerraDG.Basis, Integer}"><code>Base.size</code></a></li><li><a href="#TerraDG.area"><code>TerraDG.area</code></a></li><li><a href="#TerraDG.compute_slope_limiting_coefficients!"><code>TerraDG.compute_slope_limiting_coefficients!</code></a></li><li><a href="#TerraDG.cpu"><code>TerraDG.cpu</code></a></li><li><a href="#TerraDG.derivativematrix"><code>TerraDG.derivativematrix</code></a></li><li><a href="#TerraDG.evaluate_basis"><code>TerraDG.evaluate_basis</code></a></li><li><a href="#TerraDG.evaluate_boundary"><code>TerraDG.evaluate_boundary</code></a></li><li><a href="#TerraDG.evaluate_dof_points"><code>TerraDG.evaluate_dof_points</code></a></li><li><a href="#TerraDG.evaluate_error"><code>TerraDG.evaluate_error</code></a></li><li><a href="#TerraDG.evaluate_face_integrals"><code>TerraDG.evaluate_face_integrals</code></a></li><li><a href="#TerraDG.evaluate_flux"><code>TerraDG.evaluate_flux</code></a></li><li><a href="#TerraDG.evaluate_fluxes"><code>TerraDG.evaluate_fluxes</code></a></li><li><a href="#TerraDG.evaluate_m_to_n_vandermonde_basis"><code>TerraDG.evaluate_m_to_n_vandermonde_basis</code></a></li><li><a href="#TerraDG.evaluate_rhs"><code>TerraDG.evaluate_rhs</code></a></li><li><a href="#TerraDG.evaluate_volumes"><code>TerraDG.evaluate_volumes</code></a></li><li><a href="#TerraDG.face_projection_matrix"><code>TerraDG.face_projection_matrix</code></a></li><li><a href="#TerraDG.get_device_array_type"><code>TerraDG.get_device_array_type</code></a></li><li><a href="#TerraDG.get_face_quadpoints"><code>TerraDG.get_face_quadpoints</code></a></li><li><a href="#TerraDG.get_initial_values"><code>TerraDG.get_initial_values</code></a></li><li><a href="#TerraDG.get_neighbor"><code>TerraDG.get_neighbor</code></a></li><li><a href="#TerraDG.get_nparams"><code>TerraDG.get_nparams</code></a></li><li><a href="#TerraDG.get_nvars"><code>TerraDG.get_nvars</code></a></li><li><a href="#TerraDG.get_quadpoints"><code>TerraDG.get_quadpoints</code></a></li><li><a href="#TerraDG.get_variable_name"><code>TerraDG.get_variable_name</code></a></li><li><a href="#TerraDG.globalposition"><code>TerraDG.globalposition</code></a></li><li><a href="#TerraDG.interpolate_initial_dofs"><code>TerraDG.interpolate_initial_dofs</code></a></li><li><a href="#TerraDG.inverse_jacobian"><code>TerraDG.inverse_jacobian</code></a></li><li><a href="#TerraDG.is_analytical_solution"><code>TerraDG.is_analytical_solution</code></a></li><li><a href="#TerraDG.is_periodic_boundary"><code>TerraDG.is_periodic_boundary</code></a></li><li><a href="#TerraDG.lagrange_1d"><code>TerraDG.lagrange_1d</code></a></li><li><a href="#TerraDG.lagrange_diff"><code>TerraDG.lagrange_diff</code></a></li><li><a href="#TerraDG.main"><code>TerraDG.main</code></a></li><li><a href="#TerraDG.make_equation"><code>TerraDG.make_equation</code></a></li><li><a href="#TerraDG.make_grid"><code>TerraDG.make_grid</code></a></li><li><a href="#TerraDG.make_mesh"><code>TerraDG.make_mesh</code></a></li><li><a href="#TerraDG.make_scenario"><code>TerraDG.make_scenario</code></a></li><li><a href="#TerraDG.make_timeintegrator"><code>TerraDG.make_timeintegrator</code></a></li><li><a href="#TerraDG.massmatrix"><code>TerraDG.massmatrix</code></a></li><li><a href="#TerraDG.max_eigenval"><code>TerraDG.max_eigenval</code></a></li><li><a href="#TerraDG.minmod_slope_limiting!"><code>TerraDG.minmod_slope_limiting!</code></a></li><li><a href="#TerraDG.plot"><code>TerraDG.plot</code></a></li><li><a href="#TerraDG.project_face_to_inner"><code>TerraDG.project_face_to_inner</code></a></li><li><a href="#TerraDG.project_flux_to_face"><code>TerraDG.project_flux_to_face</code></a></li><li><a href="#TerraDG.project_to_face"><code>TerraDG.project_to_face</code></a></li><li><a href="#TerraDG.project_to_reference_basis"><code>TerraDG.project_to_reference_basis</code></a></li><li><a href="#TerraDG.save"><code>TerraDG.save</code></a></li><li><a href="#TerraDG.set_initial_conditions"><code>TerraDG.set_initial_conditions</code></a></li><li><a href="#TerraDG.step"><code>TerraDG.step</code></a></li><li><a href="#TerraDG.volume"><code>TerraDG.volume</code></a></li><li><a href="#TerraDG.@declare_dofs"><code>TerraDG.@declare_dofs</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 17 July 2024 11:49">Wednesday 17 July 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
